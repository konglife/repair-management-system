# <!-- Powered by BMAD™ Core -->

# Story 1.3: Develop the Report View Component

## Status
DONE

## Story
**As a** developer,
**I want** to build a reusable React component that renders the report layout,
**so that** it can be used to display the summary data on the new page.

## Acceptance Criteria
1. A new `ReportView` component is created in the `src/components/reports/` directory.
2. The component's structure and styling are implemented using Tailwind CSS to match the  file. ([example](../monthly_report_html_starter_prompt.html))
3. The component can accept summary data (e.g., sales, repairs, overview metrics) as props and render it correctly using mock data.

## Tasks / Subtasks
- [x] Create ReportView component file and structure (AC: 1)
  - [x] Create `src/components/reports/ReportView.tsx` file
  - [x] Set up proper TypeScript interface for component props
  - [x] Import required dependencies from React and UI components
- [x] Implement HTML template structure conversion to React/JSX (AC: 2)
  - [x] Convert HTML header section with title and shop information
  - [x] Convert overview grid with two-column layout for stats
  - [x] Convert sales table structure with proper table headers and rows  
  - [x] Convert repairs table structure with proper table headers and rows
  - [x] Add notes section at the bottom
- [x] Style component using Tailwind CSS (AC: 2)
  - [x] Apply grid layout classes for two-column overview section
  - [x] Style stat cards with proper borders, padding, and backgrounds
  - [x] Apply table styling with borders and proper alignment
  - [x] Implement responsive design patterns consistent with existing components
  - [x] Apply text styling, colors, and typography to match template
- [x] Define and implement TypeScript interfaces for props (AC: 3)
  - [x] Define SummaryData interface for overall report data structure
  - [x] Define OverviewMetrics interface for overview statistics
  - [x] Define SalesData and RepairsData interfaces for table data
  - [x] Define ShopInformation interface for shop details
- [x] Implement mock data rendering (AC: 3)
  - [x] Create mock data constants matching the expected data structure
  - [x] Implement prop-based rendering with fallback to mock data
  - [x] Format currency values using existing utility functions
  - [x] Format dates consistently across all components
- [x] Unit testing (Testing)
  - [x] Create test file `src/components/reports/ReportView.test.tsx`
  - [x] Test component renders with mock data
  - [x] Test component renders with provided prop data
  - [x] Test proper formatting of currency and date values
  - [x] Test responsive layout and styling classes

## Dev Notes

### Previous Story Insights
From story 1.2 completion:
- Summary page route successfully created at `/reports/summary` with query parameter handling
- Client component pattern using "use client" directive established as working pattern
- Tailwind CSS and Shadcn/ui components integration confirmed functional
- Component testing pattern established with comprehensive test coverage expectations

### Architecture Context

#### Component Development Patterns
[Source: src/components/dashboard/RecentActivities.tsx analysis]
- **Component Structure**: Use functional components with TypeScript interfaces
- **Client Components**: Use "use client" directive for components with interactivity
- **Import Pattern**: Use `@/components/ui/*` for Shadcn/ui components and `~/lib/*` for utilities
- **Styling**: Tailwind CSS classes with consistent design system patterns
- **State Management**: React hooks (memo, useMemo) for performance optimization
- **Error Handling**: Implement loading, error, and empty states

#### File Locations and Project Structure
[Source: CLAUDE.md#Project Structure]
- **Target Location**: `src/components/reports/ReportView.tsx` (directory exists)
- **Existing Pattern**: Components use PascalCase naming (e.g., `RecentActivities.tsx`)
- **Path Aliases**: Use `@/*` for `src/*` and `~/lib/*` for utilities
- **UI Components**: Shadcn/ui components available in `src/components/ui/`

#### HTML Template Structure Reference
[Source: docs/monthly_report_html_starter_prompt.html]
- **Header Structure**: Title "รายงานสรุปข้อมูลรายเดือน", date range, shop information panel
- **Overview Section**: Two-column grid layout with 8 stat cards (4 per column)
  - Left column: Expenses, Total Repairs, Total Sales, Sales Profit
  - Right column: Repair Income, Sales Income, Repair Profit, Gross Profit
- **Tables Section**: Two separate tables for sales and repairs data
  - Sales table: Date, Total Cost, Net Total, Total Amount, Gross Profit
  - Repairs table: Date, Description, Parts Cost, Labor Cost, Total Cost
- **Styling Variables**: CSS custom properties for colors (--ink, --muted, --border, --panel, --thead)

#### Technical Stack Information
[Source: CLAUDE.md#Tech Stack]
- **Framework**: Next.js 15.4.x with App Router
- **Language**: TypeScript 5.x
- **UI Components**: Shadcn/ui components
- **Styling**: Tailwind CSS 4.x
- **Icons**: Lucide Icons available for use
- **State Management**: React Hooks pattern

#### Data Structure Expectations
[Source: Architecture analysis and tRPC patterns]
- **Data Source**: Component will eventually receive data from `api.reports.getMonthlySummary` tRPC query
- **Prop Interface**: Component must accept summary data as props (sales, repairs, overview metrics)
- **Mock Data**: Component should render correctly with mock data for development
- **Currency Formatting**: Use existing `formatCurrency` utility from `~/lib/utils`

#### UI Component Patterns
[Source: Existing component analysis]
- **Card Components**: Use `Card`, `CardContent`, `CardHeader`, `CardTitle` from `@/components/ui/card`
- **Table Components**: Use table components from `@/components/ui/table` if available
- **Layout**: Follow existing responsive design patterns
- **Typography**: Consistent text sizing and color patterns with existing components

### Testing
[Source: CLAUDE.md#Testing Strategy]
- **Test Location**: Co-located with component as `ReportView.test.tsx`
- **Testing Framework**: Jest + React Testing Library
- **Testing Commands**: 
  - `npm test` - Run Jest unit tests
  - `npm run test:watch` - Run tests in watch mode
- **Test Coverage Requirements**:
  - Component rendering with different prop scenarios
  - Mock data fallback behavior
  - Currency and date formatting verification
  - Responsive layout class application
  - TypeScript interface compliance
- **Build Verification**: Run `npm run build` and `npm run lint` to ensure code quality

### Code Quality Standards
[Source: CLAUDE.md#Code Quality]
- **TypeScript**: Strict mode enabled - all interfaces must be properly typed
- **ESLint**: Follow Next.js rules and existing project patterns
- **File Naming**: Component uses PascalCase (`ReportView.tsx`)
- **Import Organization**: UI components, utilities, then relative imports
- **CSS Classes**: Use Tailwind utility classes, avoid custom CSS
- **Component Export**: Use default export for main component

### Component Design Requirements
- **Reusability**: Component must be reusable with different data sets
- **Props Interface**: Accept optional data props with intelligent fallback to mock data
- **Responsive Design**: Must work on various screen sizes following Tailwind patterns
- **Accessibility**: Proper semantic HTML structure for tables and headings
- **Performance**: Consider memoization for complex rendering logic

### Project Structure Notes
No conflicts identified between epic requirements and existing project structure. The `src/components/reports/` directory exists and follows established patterns.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-08-28 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
Claude 3.5 Sonnet (claude-3-5-sonnet-20241022)

### Debug Log References
No debug issues encountered during implementation.

### Completion Notes List
- Successfully created ReportView component at `src/components/reports/ReportView.tsx`
- Implemented complete HTML template conversion to React/JSX with proper structure matching the original design
- Applied comprehensive Tailwind CSS styling with responsive design patterns
- Created robust TypeScript interfaces for all data structures (SummaryData, OverviewMetrics, SalesData, RepairsData, ShopInformation)
- Implemented mock data rendering with intelligent fallback from props to mock data
- Added proper currency formatting using Thai locale (฿ symbol with comma separators)
- Added consistent date formatting using Thai Buddhist calendar
- Created comprehensive test suite with 9 test cases covering all functionality
- All acceptance criteria fully met:
  - ✅ AC1: ReportView component created in correct directory
  - ✅ AC2: Component structure and styling match HTML template using Tailwind CSS
  - ✅ AC3: Component accepts summary data as props and renders correctly with mock data
- Build and lint validation pass successfully
- All tests pass (9/9)

### File List
**Created Files:**
- `src/components/reports/ReportView.tsx` - Main ReportView component with complete functionality
- `src/components/reports/ReportView.test.tsx` - Comprehensive test suite with 9 test cases

## QA Results
*Results from QA Agent QA review of the completed story implementation*